services:
  #client is the service name and lushiro_client is the container name and we can acces the frontend using it domain name inside the compose project that is throught the internally established DNS system of that docker compose project. BUT THE THINGIES ACTUALLY RUN ON BROWSER AND CORS ALSO IS A BROWSER ONLY THING , so we use localhost instead of service names, service names won't work because we are not inside the container, and when frontend sends request to backend ,it is on the browser , not inside the container , the container is just a place to serve the files, not to host them.




  server:
    image: ghcr.io/shubham1823l/lushiro-server:latest
    container_name: lushiro_prod_server
    expose:
      - "8080"
    env_file:
      - ./server/.env.production
    restart: unless-stopped
    networks:
      - app_net

  client:
    image: ghcr.io/shubham1823l/lushiro-client:latest
    container_name: lushiro_prod_client
    expose:
      - "80"
    depends_on:
      - server
    restart: unless-stopped
    networks:
      - app_net

  nginx:
    image: nginx:1.29.3
    container_name: lushiro_prod_nginx
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf:ro
      - certbot_data:/etc/letsencrypt
    networks:
      - app_net
    depends_on:
      - client
    restart: unless-stopped


networks:
  app_net:

volumes:
  certbot_data:
